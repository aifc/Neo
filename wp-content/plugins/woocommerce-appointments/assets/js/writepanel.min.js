jQuery(document).ready(function(a){"use strict";var b={init:function(){a("#appointments_availability, #appointments_pricing").on("change",".wc_appointment_availability_type select, .wc_appointment_pricing_type select",this.wc_appointments_table_grid),a("body").on("row_added",this.wc_appointments_row_added),a("body").on("woocommerce-product-type-change",this.wc_appointments_trigger_change_events),a("input#_virtual").on("change",this.wc_appointments_trigger_change_events),a("#_wc_appointment_user_can_cancel").on("change",this.wc_appointments_user_cancel),a("#_wc_appointment_qty").on("change",this.wc_appointments_qty),a("#_wc_appointment_qty_min").on("change",this.wc_appointments_qty_min),a("#_wc_appointment_qty_max").on("change",this.wc_appointments_qty_max),a("#_wc_appointment_has_price_label").on("change",this.wc_appointments_price_label),a("#_wc_appointment_has_pricing").on("change",this.wc_appointments_pricing),a("#_wc_appointment_staff_assignment").on("change",this.wc_appointments_staff_assignment),a("#_wc_appointment_duration_unit").on("change",this.wc_appointment_duration_unit),a("body").on("click",".add_row",this.wc_appointments_table_grid_add_row),a("body").on("click","td.remove",this.wc_appointments_table_grid_remove_row),a("#appointments_staff").on("click","button.add_staff",this.wc_appointments_add_staff),a("#appointments_staff").on("click","button.remove_appointment_staff",this.wc_appointments_remove_staff),b.wc_appointments_trigger_change_events(),a("#availability_rows, #pricing_rows").sortable({items:"tr",cursor:"move",axis:"y",handle:".sort",scrollSensitivity:40,forcePlaceholderSize:!0,helper:"clone",opacity:.65,placeholder:{element:function(){return a('<tr class="wc-metabox-sortable-placeholder"><td colspan=99>&nbsp;</td></tr>')[0]},update:function(){}},start:function(a,b){b.item.css("background-color","#f6f6f6")},stop:function(a,b){b.item.removeAttr("style")}}),a(".date-picker").datepicker({dateFormat:"yy-mm-dd",numberOfMonths:1,showOtherMonths:!0,changeMonth:!0,showButtonPanel:!0,showOn:"button",minDate:0,buttonText:'<span class="dashicons dashicons-calendar-alt"></span>'}),a(".woocommerce_appointable_staff").sortable({items:".woocommerce_appointment_staff",cursor:"move",axis:"y",handle:"h3",scrollSensitivity:40,forcePlaceholderSize:!0,helper:"clone",opacity:.65,placeholder:"wc-metabox-sortable-placeholder",start:function(a,b){b.item.css("background-color","#f6f6f6")},stop:function(a,c){c.item.removeAttr("style"),b.staff_row_indexes()}}),a("#_wc_appointment_cal_color").wpColorPicker()},wc_appointments_table_grid:function(){var b=a(this).val(),c=a(this).closest("tr");return a(c).find(".from_date, .from_day_of_week, .from_month, .from_week, .from_time, .from").hide(),a(c).find(".to_date, .to_day_of_week, .to_month, .to_week, .to_time, .to, .on_date").hide(),a(".repeating-label").hide(),a(c).find(".appointments-datetime-select-to").removeClass("appointments-datetime-select-both"),a(c).find(".appointments-datetime-select-from").removeClass("appointments-datetime-select-both"),"custom"===b&&a(c).find(".from_date, .to_date").show(),"months"===b&&a(c).find(".from_month, .to_month").show(),"weeks"===b&&a(c).find(".from_week, .to_week").show(),"days"===b&&a(c).find(".from_day_of_week, .to_day_of_week").show(),b.match("^time")&&(a(c).find(".from_time, .to_time").show(),"time:range"===b&&(a(c).find(".from_date, .to_date").show(),a(".repeating-label").show(),a(c).find(".appointments-datetime-select-to").addClass("appointments-datetime-select-both"),a(c).find(".appointments-datetime-select-from").addClass("appointments-datetime-select-both"))),("duration"===b||"slots"===b||"quant"===b)&&a(c).find(".from, .to").show(),!1},wc_appointments_row_added:function(){return a(".wc_appointment_availability_type select, .wc_appointment_pricing_type select").change(),a(".date-picker").datepicker({dateFormat:"yy-mm-dd",numberOfMonths:1,showOtherMonths:!0,changeMonth:!0,showButtonPanel:!0,showOn:"button",buttonText:'<span class="dashicons dashicons-calendar-alt"></span>'}),!1},wc_appointments_trigger_change_events:function(){return a(".wc_appointment_availability_type select, .wc_appointment_pricing_type select, #_wc_appointment_user_can_cancel, #_wc_appointment_has_price_label, #_wc_appointment_has_pricing, #_wc_appointment_duration_unit, #_wc_appointment_staff_assignment, #_wc_appointment_qty, #_wc_appointment_qty_min, #_wc_appointment_qty_max").change(),!1},wc_appointments_user_cancel:function(){return a(this).is(":checked")?a(".form-field.appointment-cancel-limit").show():a(".form-field.appointment-cancel-limit").hide(),!1},wc_appointments_qty:function(){var b=parseInt(a(this).val(),10),c=parseInt(a("#_wc_appointment_qty_min").val(),10),d=parseInt(a("#_wc_appointment_qty_max").val(),10);return b>1?(a(".form-field._wc_appointment_customer_qty_wrap").show(),a("#_wc_appointment_qty_min").prop("max",b),a("#_wc_appointment_qty_max").prop("max",b)):a(".form-field._wc_appointment_customer_qty_wrap").hide(),c>b&&a("#_wc_appointment_qty_min").val(b),d>b&&a("#_wc_appointment_qty_max").val(b),!1},wc_appointments_qty_min:function(){var b=parseInt(a(this).val(),10),c=parseInt(a("#_wc_appointment_qty_max").val(),10);return b>c&&a("#_wc_appointment_qty_max").val(b),!1},wc_appointments_qty_max:function(){var b=parseInt(a(this).val(),10),c=parseInt(a("#_wc_appointment_qty_min").val(),10);return c>b&&a("#_wc_appointment_qty_min").val(b),!1},wc_appointments_price_label:function(){return a(this).is(":checked")?(a(".options_group.pricing").show(),a(".form-field._wc_appointment_price_label_field").show()):(a(".options_group.pricing").show(),a(".form-field._wc_appointment_price_label_field").hide()),!1},wc_appointments_pricing:function(){return a(this).is(":checked")?a("#appointments_pricing").show():a("#appointments_pricing").hide(),!1},wc_appointments_staff_assignment:function(){return"customer"===a(this).val()?a(".form-field._wc_appointment_staff_label_field").show():a(".form-field._wc_appointment_staff_label_field").hide(),!1},wc_appointment_duration_unit:function(){return"day"===a(this).val()?(a(".form-field._wc_appointment_interval_duration_wrap").hide(),a('#_wc_appointment_padding_duration_unit option[value="minute"]').hide(),a('#_wc_appointment_padding_duration_unit option[value="hour"]').hide(),a('#_wc_appointment_padding_duration_unit option[value="day"]').show(),a("#_wc_appointment_padding_duration_unit").val("day")):(a(".form-field._wc_appointment_interval_duration_wrap").show(),a('#_wc_appointment_padding_duration_unit option[value="minute"]').show(),a('#_wc_appointment_padding_duration_unit option[value="hour"]').show(),a('#_wc_appointment_padding_duration_unit option[value="day"]').hide()),!1},wc_appointments_table_grid_add_row:function(){return a(this).closest("table").find("tbody").append(a(this).data("row")),a("body").trigger("row_added"),!1},wc_appointments_table_grid_remove_row:function(){return a(this).closest("tr").remove(),!1},wc_appointments_add_staff:function(){var b=a(".woocommerce_appointment_staff").length,c=parseInt(jQuery("select.add_staff_id").val(),10),d="";a(".woocommerce_appointable_staff").block({message:null});var e={action:"woocommerce_add_appointable_staff",post_id:wc_appointments_writepanel_js_params.post,loop:b,add_staff_id:c,add_staff_name:d,security:wc_appointments_writepanel_js_params.nonce_add_staff};return a.post(wc_appointments_writepanel_js_params.ajax_url,e,function(b){b.error?(alert(b.error),a(".woocommerce_appointable_staff").unblock()):(a(".woocommerce_appointable_staff").append(b.html).unblock(),a(".woocommerce_appointable_staff").sortable("refresh"))}),!1},wc_appointments_remove_staff:function(b){b.preventDefault();var c=confirm(wc_appointments_writepanel_js_params.i18n_remove_staff);if(c){var d=a(this).parent().parent(),e=a(this).attr("rel");a(d).block({message:null});var f={action:"woocommerce_remove_appointable_staff",post_id:wc_appointments_writepanel_js_params.post,staff_id:e,security:wc_appointments_writepanel_js_params.nonce_delete_staff};a.post(wc_appointments_writepanel_js_params.ajax_url,f,function(){a(d).fadeOut("300",function(){a(d).remove()})})}return!1},staff_row_indexes:function(){return a(".woocommerce_appointable_staff .woocommerce_appointment_staff").each(function(b,c){a(".staff_menu_order",c).val(parseInt(a(c).index(".woocommerce_appointable_staff .woocommerce_appointment_staff"),10))}),!1}};b.init()});