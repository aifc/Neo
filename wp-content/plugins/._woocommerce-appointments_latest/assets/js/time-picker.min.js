jQuery(document).ready(function(a){"use strict";var b,c={init:function(){a(".slot-picker").on("click","a",function(){var b=a(this).closest("form"),d=a(this).parent().data("slot");return c.set_selected_time(b,d),!1}),a("body").on("change","#wc_appointments_field_staff",function(){c.show_available_time_slots(this)}),a(".wc-appointments-appointment-form").parents("form").on("date-selected",function(){c.show_available_time_slots(this)})},time_picker_init:function(){var b=a(this).data("value"),c=a(this).parents(".form-field").find("input"),d=a(this).closest("form");return c.val(b),a(this).parents(".form-field").find("li").removeClass("selected"),a(this).parents("li").addClass("selected"),d.triggerHandler("time-selected"),!1},set_selected_time:function(a,b){var c=a.find(".wc-appointments-appointment-form-button"),d=a.find(".slot-picker");if(c.addClass("disabled"),void 0===b)return void a.triggerHandler("time-selected");var e=d.find('[data-slot="'+b+'"]'),f=e.find("a").data("value");if(void 0===e.data("slot"))return void a.triggerHandler("time-selected");var g=a.find(".slot-picker").parent("div").find("input");g.val(f),g.attr("data-value",b),a.triggerHandler("time-selected"),d.find("li").removeClass("selected"),e.addClass("selected")},show_available_time_slots:function(d){var e=a(d).closest("form"),f=e.find(".slot-picker"),g=e.find("fieldset"),h=parseInt(g.find("input.appointment_date_year").val(),10),i=parseInt(g.find("input.appointment_date_month").val(),10),j=parseInt(g.find("input.appointment_date_day").val(),10),k=f.find(".selected");h&&i&&j&&(f.closest("div").find("input").val("").change(),f.closest("div").block({message:null,overlayCSS:{background:"#fff",backgroundSize:"16px 16px",opacity:.6}}).show(),b=a.ajax({type:"POST",url:wc_appointment_form_params.ajax_url,data:{action:"wc_appointments_get_slots",form:e.serialize(),timezone:jstz.determine().name()},success:function(a){if(f.html(a),f.closest("div").unblock(),c.set_selected_time(e,k.data("slot")),null!==get_querystring("time")){var b=f.find('li.slot[data-slot="'+get_querystring("time")+'"]').not(".slot_empty");b.length>0?b.find("a").click():c.autoselect_first_available_time(e)}else wc_appointment_form_params.is_autoselect&&c.autoselect_first_available_time(e)},dataType:"html"}))},autoselect_first_available_time:function(a){var b=a.find(".slot-picker"),c=b.find('li.slot:not(".slot_empty"):first');c.length>0&&c.has("a")&&c.find("a").click()}};c.init()});